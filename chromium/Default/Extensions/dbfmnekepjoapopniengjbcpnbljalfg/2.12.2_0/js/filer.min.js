var self=this;if(self.URL=self.URL||self.webkitURL,self.requestFileSystem=self.requestFileSystem||self.webkitRequestFileSystem,self.resolveLocalFileSystemURL=self.resolveLocalFileSystemURL||self.webkitResolveLocalFileSystemURL,navigator.temporaryStorage=navigator.temporaryStorage||navigator.webkitTemporaryStorage,navigator.persistentStorage=navigator.persistentStorage||navigator.webkitPersistentStorage,self.BlobBuilder=self.BlobBuilder||self.MozBlobBuilder||self.WebKitBlobBuilder,void 0===self.FileError){var FileError=function(){};FileError.prototype.prototype=Error.prototype}var Util={toArray:function(e){return Array.prototype.slice.call(e||[],0)},strToDataURL:function(e,t,r){return(void 0!=r?r:1)?"data:"+t+";base64,"+self.btoa(e):"data:"+t+","+e},strToObjectURL:function(e,t){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)r[o]=e.charCodeAt(o);return r=new Blob([r],t?{type:t}:{}),self.URL.createObjectURL(r)},fileToObjectURL:function(e){return self.URL.createObjectURL(e)},fileToArrayBuffer:function(e,t,r){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.onerror=function(e){r&&r(e)},o.readAsArrayBuffer(e)},dataURLToBlob:function(e){if(-1==e.indexOf(";base64,")){var t=e.split(","),e=t[0].split(":")[1],t=t[1];return new Blob([t],{type:e})}for(var t=e.split(";base64,"),e=t[0].split(":")[1],t=window.atob(t[1]),r=t.length,o=new Uint8Array(r),i=0;i<r;++i)o[i]=t.charCodeAt(i);return new Blob([o],{type:e})},arrayBufferToBlob:function(e,t){var r=new Uint8Array(e);return new Blob([r],t?{type:t}:{})},arrayBufferToBinaryString:function(e,t,r){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.onerror=function(e){r&&r(e)},e=new Uint8Array(e),o.readAsBinaryString(new Blob([e]))},arrayToBinaryString:function(e){if("object"!=typeof e)return null;for(var t=e.length,r=Array(t);t--;)r[t]=String.fromCharCode(e[t]);return r.join("")},getFileExtension:function(e){var t=e.lastIndexOf(".");return-1!=t?e.substring(t):""}},MyFileError=function(e){this.prototype=FileError.prototype,this.code=e.code,this.name=e.name};FileError.BROWSER_NOT_SUPPORTED=1e3,FileError.prototype.__defineGetter__("name",function(){for(var e,t=Object.keys(FileError),r=0;e=t[r];++r)if(FileError[e]==this.code)return e;return"Unknown Error"});var Filer=new function(){function e(e){(t=e||null)&&(r=t.root,o=!0)}var t=null,r=null,o=!1,i=function(e){return 0==e.indexOf("filesystem:")},n=function(e){return i(e)||(e="/"==e[0]?t.root.toURL()+e.substring(1):0==e.indexOf("./")||0==e.indexOf("../")?"../"==e&&r!=t.root?r.toURL()+"/"+e:r.toURL()+e:r.toURL()+"/"+e),e},s=function(e,t){var r=arguments[1],o=arguments[2],i=function(e){if(e.code==FileError.NOT_FOUND_ERR){if(o)throw Error('"'+r+'" or "'+o+'" does not exist.');throw Error('"'+r+'" does not exist.')}throw Error("Problem getting Entry for one or more paths.")},s=n(r);if(3==arguments.length){var a=n(o);self.resolveLocalFileSystemURL(s,function(t){self.resolveLocalFileSystemURL(a,function(r){e(t,r)},i)},i)}else self.resolveLocalFileSystemURL(s,e,i)},a=function(e,r,o,i,n,a){if(!t)throw Error("Filesystem has not been initialized.");if(typeof e!=typeof r)throw Error("These method arguments are not supported.");var l=o||null,f=void 0!=a&&a;(e.isFile||r.isDirectory)&&r.isDirectory?f?e.moveTo(r,l,i,n):e.copyTo(r,l,i,n):s(function(e,t){if(t.isDirectory)f?e.moveTo(t,l,i,n):e.copyTo(t,l,i,n);else{var r=Error('Oops! "'+t.name+" is not a directory!");if(!n)throw r;n(r)}},e,r)};return e.DEFAULT_FS_SIZE=1048576,e.version="0.4.3",e.prototype={get fs(){return t},get isOpen(){return o},get cwd(){return r}},e.prototype.pathToFilesystemURL=function(e){return n(e)},e.prototype.init=function(e,i,n){if(!self.requestFileSystem)throw new MyFileError({code:FileError.BROWSER_NOT_SUPPORTED,name:"BROWSER_NOT_SUPPORTED"});var e=e?e:{},s=e.size||1048576;this.type=self.TEMPORARY,"persistent"in e&&e.persistent&&(this.type=self.PERSISTENT);var a=function(e){this.size=s,t=e,r=t.root,o=!0,i&&i(e)};this.type==self.PERSISTENT&&navigator.persistentStorage?navigator.persistentStorage.requestQuota(s,function(e){self.requestFileSystem(this.type,e,a.bind(this),n)}.bind(this),n):self.requestFileSystem(this.type,s,a.bind(this),n)},e.prototype.ls=function(e,o,n){if(!t)throw Error("Filesystem has not been initialized.");var a=function(e){r=e;var t=[],i=r.createReader(),s=function(){i.readEntries(function(e){e.length?(t=t.concat(Util.toArray(e)),s()):(t.sort(function(e,t){return e.name<t.name?-1:t.name<e.name?1:0}),o(t))},n)};s()};e.isDirectory?a(e):i(e)?s(a,e):r.getDirectory(e,{},a,n)},e.prototype.mkdir=function(e,o,i,n){if(!t)throw Error("Filesystem has not been initialized.");var s=null!=o&&o,a=e.split("/"),l=function(t,r){"."!=r[0]&&""!=r[0]||(r=r.slice(1)),t.getDirectory(r[0],{create:!0,exclusive:s},function(t){if(t.isDirectory)r.length&&1!=a.length?l(t,r.slice(1)):i&&i(t);else{if(t=Error(e+" is not a directory"),!n)throw t;n(t)}},function(t){if(t.code==FileError.INVALID_MODIFICATION_ERR){if(t.message="'"+e+"' already exists",!n)throw t;n(t)}})};l(r,a)},e.prototype.open=function(e,r,o){if(!t)throw Error("Filesystem has not been initialized.");e.isFile?e.file(r,o):s(function(e){e.file(r,o)},n(e))},e.prototype.create=function(e,o,i,n){if(!t)throw Error("Filesystem has not been initialized.");r.getFile(e,{create:!0,exclusive:null==o||o},i,function(t){if(t.code==FileError.INVALID_MODIFICATION_ERR&&(t.message="'"+e+"' already exists"),!n)throw t;n(t)})},e.prototype.mv=function(e,t,r,o,i){a.bind(this,e,t,r,o,i,!0)()},e.prototype.rm=function(e,r,o){if(!t)throw Error("Filesystem has not been initialized.");var i=function(e){e.isFile?e.remove(r,o):e.isDirectory&&e.removeRecursively(r,o)};e.isFile||e.isDirectory?i(e):s(i,e)},e.prototype.cd=function(e,o,i){if(!t)throw Error("Filesystem has not been initialized.");e.isDirectory?(r=e,o&&o(r)):(e=n(e),s(function(e){if(e.isDirectory)r=e,o&&o(r);else{if(e=Error("Path was not a directory."),!i)throw e;i(e)}},e))},e.prototype.cp=function(e,t,r,o,i){a.bind(this,e,t,r,o,i)()},e.prototype.write=function(e,o,n,a){if(!t)throw Error("Filesystem has not been initialized.");var l=function(e){e.createWriter(function(t){if(t.onerror=a,o.append)t.onwriteend=function(){n&&n(e,this)},t.seek(t.length);else{var r=!1;t.onwriteend=function(){r?n&&n(e,this):(r=!0,this.truncate(this.position))}}o.data.__proto__==ArrayBuffer.prototype&&(o.data=new Uint8Array(o.data));var i=new Blob([o.data],o.type?{type:o.type}:{});t.write(i)},a)};e.isFile?l(e):i(e)?s(l,e):r.getFile(e,{create:!0,exclusive:!1},l,a)},e.prototype.df=function(e,t){var r=function(t,r){e(t,r-t,r)};if(!navigator.temporaryStorage.queryUsageAndQuota||!navigator.persistentStorage.queryUsageAndQuota)throw Error("Not implemented.");self.TEMPORARY==this.type?navigator.temporaryStorage.queryUsageAndQuota(r,t):self.PERSISTENT==this.type&&navigator.persistentStorage.queryUsageAndQuota(r,t)},e};