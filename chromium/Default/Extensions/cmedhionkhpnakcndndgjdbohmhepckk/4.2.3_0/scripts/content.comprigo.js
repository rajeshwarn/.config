!function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}({0:function(e,r,t){e.exports=t(72)},72:function(e,r,t){"use strict";t(73)},73:function(e,r){"use strict";!function(){window.browserAppBase,document.getElementById("cleanIframe")||(window.browserAppBase={library:{},core:{},engine:{},ui:{},index:{}},browserAppBase.originName="comprigo",browserAppBase.library.natives=function(){var e=document.createElement("iframe");return e.id="cleanIframe",e.src="about:blank",e.style.display="none",document.body.appendChild(e),e.contentWindow}(),browserAppBase.library.objectManipulations=function(){var e={exports:{}},r={hasProperties:function(e,r){for(var t in r){if(!e.hasOwnProperty(t))return!1;if(!this.hasProperties(e[t],r[t]))return!1}return!0},ensureProperties:function(e,r){for(var t in r)e.hasOwnProperty(t)||(e[t]=r[t]),this.isObject(r[t])&&(this.isEmpty(r[t])||this.ensureProperties(e[t],r[t]));return e},hasOwnValue:function(e,r){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===r)return!0;return!1},isEmpty:function(e){return!!this.isObject(e)&&0===Object.keys(e).length},isObject:function(e){return null!==e&&"object"==typeof e}};return e.exports=r,e.exports}(),browserAppBase.library.logger=function(){function e(){var e=null;return e="live"===browserAppBase.environment?function(e,r,t){}:function(e,r,t){if(window.console)try{}catch(e){try{}catch(e){}}},{error:function(r,t){e("error",r,t)},info:function(r,t){e("info",r,t)},warn:function(r,t){e("warn",r,t)},log:function(r,t){e("log",r,t)}}}var r={exports:{}};return browserAppBase.environment="live",r.exports=new e,r.exports}(),browserAppBase.library.eventHandlers=function(){var e={exports:{}};return e.exports={addEventListener:function(e,r,t){e.addEventListener?e.addEventListener(r,t,!1):e.attachEvent&&e.attachEvent("on"+r,t)},fireEvent:function(e,r){parent.postMessage(browserAppBase.library.natives.JSON.stringify({event:e,data:r}),"*")}},e.exports}(),browserAppBase.library.promiseCollection=function(){var e={exports:{}};return e.exports=function(){var e,r=[],t=!1,n=function(){for(var e=0;e<r.length;e++)r[e]();r.slice(0,r.length)};return{registerPromise:function(){return new Promise(function(n,o){return t?void n.apply(null,e):void r.push(function(){n.apply(null,e)})})},invoke:function(){e=arguments,n(),t=!0}}},e.exports}(),browserAppBase.library.fixMainPageScroll=function(){function e(){for(;n.cssRules.length;)n.deleteRule(0);var e=document.scrollingElement.scrollHeight,r=document.documentElement.clientHeight,t="";t=r<e?".scrollFix {position: fixed; overflow-y: scroll; width: 100%;}":".scrollFix {position: fixed; overflow-y: auto; width: 100%;}",n.insertRule(t,0)}function r(e){function r(){a=document.scrollingElement.scrollTop,document.documentElement.style.top=-a+"px",document.documentElement.classList.add("scrollFix"),document.scrollingElement.scrollTop=a,n.insertRule(o,0)}function t(){document.documentElement.classList.remove("scrollFix"),document.scrollingElement.scrollTop=a,n.deleteRule(0)}var a=0;document.getElementById(e).addEventListener("mouseenter",r),document.getElementById(e).addEventListener("mouseleave",t)}var t={exports:{}},n=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}();!function(){var e=function(e,r,t){t=t||window;var n=!1,o=function(){n||(n=!0,requestAnimationFrame(function(){t.dispatchEvent(new CustomEvent(r)),n=!1}))};t.addEventListener(e,o)};e("resize","optimizedResize")}(),e(),window.addEventListener("optimizedResize",e);var o=[".ml-header"].join(", ")+" {display: none !important;}";return t.exports=r,t.exports}(),browserAppBase.core.init=function(){var e={exports:{}},r=browserAppBase.library.objectManipulations,t=function(){var e,t=[],n={blocked:{cp:!1,pv:!1,rules:!1},partner:{id:1072,partnerId:1072,sub_id:"default",subId:"default"},rules:{},user:{uid:"",ext:"",locale:""},browser:{sf:!0},baseUrl:"https://go."+browserAppBase.originName+".com",aboutLink:"http://www."+browserAppBase.originName+".com/about/",tldArray:["com"],domain:{},config:{}},o=function(e){for(var r=0;r<t.length;r++)t[r](e);t.splice(0,t.length)};return{done:function(){return new Promise(function(r,n){e?r(e):t.push(function(){r(e)})})},call:function(t){e=r.ensureProperties(t,n),e.partner.applink=function(){return t.partner.applink?t.partner.applink:null}(),e.partner.appid=function(){if(t.partner.appid)return t.partner.appid;if(1052==t.partner.id){var e="fxfxdl";try{return window["__rvz"+e].product_name}catch(e){return null}}return 1006!=t.partner.id?null:void 0}(),o(e)}}}();return e.exports=t,e.exports}(),browserAppBase.library.browserCheck=function(){var e={exports:{}},r=function(){return new Promise(function(e,r){var t=document.documentMode,n=function(){if(document.documentMode){try{delete document.documentMode}catch(e){}return t===document.documentMode||(document.documentMode=t,!1)}},o=function(){var e=document.createElement("div");return e.innerHTML="<!--[if IE]><i></i><![endif]-->",1===e.getElementsByTagName("i").length};e(n()?t>8?{supported:!0,ie:!0}:{supported:!1}:o()?{supported:!1}:{supported:!0})})};return e.exports=r,e.exports}(),browserAppBase.library.crossIframeManager=function(){function e(){function e(e,r){for(var t=e.length;t--;)return e[t].win===r}function r(e){var r=null,t=e.source,n=e.origin,a=null,s=null,c=null;try{r=browserAppBase.library.natives.JSON.parse(e.data)}catch(e){return}if("string"==typeof r.method){var u=r.method.split("::");2==u.length?(a=u[0],c=u[1]):c=r.method}if("undefined"!=typeof r.id&&(s=r.id),"string"==typeof c){var l=!1;if(o[n]&&o[n][a])for(var p=0;p<o[n][a].length;p++)if(o[n][a][p].win===t){o[n][a][p].handler(n,c,r),l=!0;break}if(!l&&o["*"]&&o["*"][a])for(var d=0;d<o["*"][a].length;d++)if(o["*"][a][d].win===t){o["*"][a][d].handler(n,c,r);break}}else"undefined"!=typeof s&&i[s]&&i[s](n,c,r)}var n=Math.floor(1000001*Math.random()),o={},a="[CROSS IFRAME MANAGER]",i={};window.addEventListener("message",r,!1),this.createChannel=function(r){function s(e,r,n){var o=!1,i=!1;return{origin:r,invoke:function(r,o){if(!b[e])return void t.error("invalid transaction id on invoke",a);for(var i=!1,s=0;s<n.length;s++)if(r===n[s]){i=!0;break}return i?void l({id:e,callback:r,params:o}):void t.error('invalid callback "'+r+'" on invoke',a)},error:function(r,n){return i=!0,b[e]?(delete b[e],void l({id:e,error:r,message:n})):void t.error("error call on non-existent message",a)},complete:function(r){return i=!0,b[e]?(delete b[e],void l({id:e,result:r})):void t.error("complete call on non-existent message",a)},delayReturn:function(e){return"boolean"==typeof e&&(o=e===!0),o},completed:function(){return i}}}function c(e,r,n){if(n.id&&r){if(m[r]){var o=s(n.id,e,n.callbacks?n.callbacks:[]);b[n.id]={};try{if(n.callbacks&&n.callbacks.constructor.toString().indexOf("Array")!==-1&&n.callbacks.length>0)for(var c=0;c<n.callbacks.length;c++){for(var u=n.callbacks[c],l=n.params,p=u.split("/"),d=0;d<p.length-1;d++){var f=p[d];"object"!=typeof l[f]&&(l[f]={}),l=l[f]}l[p[p.length-1]]=function(){var e=u;return function(r){return o.invoke(e,r)}}()}var v=m[r](o,n.params);o.delayReturn()||o.completed()||o.complete(v)}catch(e){o.error("run error",e.toString())}}}else n.id&&n.callback?g[n.id]&&g[n.id].callbacks&&g[n.id].callbacks[n.callback]?g[n.id].callbacks[n.callback](n.params):t.log("ignoring invalid callback, id:"+n.id+"("+n.callback+")",a):n.id?g[n.id]?(n.error?(0,g[n.id].error)(n.error,n.message):void 0!==n.result?(0,g[n.id].success)(n.result):(0,g[n.id].success)(),delete g[n.id],delete i[n.id]):t.log("ignoring invalid response: "+n.id,a):r&&m[r]&&m[r]({origin:e},n.params)}function u(e){return"string"==typeof r.scope&&r.scope.length&&(e=[r.scope,e].join("::")),e}function l(e,t){t||v?r.targetWindow.postMessage(browserAppBase.library.natives.JSON.stringify(e),r.targetOrigin):h.push(e)}function p(e,n){if(v)return void t.error("ready message in ready state error",a);for(x.unbind("__ready"),v=!0,"win_handshake"===n&&l({method:u("__ready"),params:"win_handshake"});h.length;)l(h.pop());r.onReady(x)}if("*"!==r.targetOrigin){var d=r.targetOrigin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/);if(null===d)return t.error("build error: invalid origin",a),!1;r.targetOrigin=d[0].toLowerCase()}var f=(0|9e8*Math.random()).toString(36),m={},g={},b={},v=!1,h=[],w=!1;if("*"===r.targetOrigin){for(var y in o)if(o.hasOwnProperty(y)&&"*"!==y&&"object"==typeof o[y][r.scope]&&(w=e(o[y][r.scope],r.targetWindow)))break}else o["*"]&&o["*"][r.scope]&&(w=e(o["*"][r.scope],r.targetWindow)),!w&&o[r.targetOrigin]&&o[r.targetOrigin][r.scope]&&(w=e(o[r.targetOrigin][r.scope],r.targetWindow));if(w)return void t.error('channel overlap on origin "'+r.targetOrigin+'" and scope "'+r.scope+'"',a);"object"!=typeof o[r.targetOrigin]&&(o[r.targetOrigin]={}),"object"!=typeof o[r.targetOrigin][r.scope]&&(o[r.targetOrigin][r.scope]=[]),o[r.targetOrigin][r.scope].push({win:r.targetWindow,handler:c});var x={unbind:function(e){try{delete m[e]}catch(e){return!1}return!0},bind:function(e,r){e&&r&&!m[e]||t.error("bind error - invalid parameters",a),m[e]=r},call:function(e){if(!e.method||!e.success)return void t.error("invlid arguments to call",a);var r={},o=[],s=[],p=function e(n,i){if(s.indexOf(i)>=0)return void t.error("some recursive error magic",a);if(s.push(i),"object"==typeof i)for(var c in i)if(i.hasOwnProperty(c)){var u=n+(n.length?"/":"")+c;"function"==typeof i[c]?(r[u]=i[c],o.push(u),delete i[c]):"object"==typeof i[c]&&e(u,i[c])}};p("",e.params);var d={id:n,method:u(e.method),params:e.params};o.length&&(d.callbacks=o),g[n]={callbacks:r,error:e.error,success:e.success},i[n]=c,n++,l(d)},destroy:function(){try{for(var e=o[r.targetOrigin][r.scope],n=0;n<e.length;n++)e[n].win===r.targetWindow&&e.splice(n,1);0===o[r.targetOrigin][r.scope].length&&delete o[r.targetOrigin][r.scope],window.removeEventListener("message",c,!1),v=!1;for(var i in m)delete m[i];for(var s in b)delete b[s];for(var u in g)delete g[u];r.targetOrigin=null,h=[],t.log('channel "'+f+'" destroyed',a),f=""}catch(e){t.error("destroy channel error: "+e.toString(),a)}}};return x.bind("__ready",p),window.setTimeout(function(){l({method:u("__ready"),params:"win_handshake"},!0)},0),x}}var r={exports:{}},t=browserAppBase.library.logger;return r.exports=function(){return!!(window.postMessage&&browserAppBase.library.natives.JSON&&browserAppBase.library.natives.JSON.parse&&browserAppBase.library.natives.JSON.stringify&&window.addEventListener)&&new e}(),r.exports}(),browserAppBase.library.pageReady=function(){var e,r={exports:{}},t=browserAppBase.library.promiseCollection(),n=browserAppBase.library.eventHandlers,o="complete"==window.document.readyState||"interactive"==window.document.readyState||"loaded"===window.document.readyState,a=function(){e=setInterval(function(){var r=window.document.getElementById("mainIframe1300"),t=window.document.getElementById("notificationIframe1300");r.style.setProperty("top","10px","important"),r.style.setProperty("bottom","auto","important"),r.style.setProperty("right","0px","important"),r.style.setProperty("left","auto","important"),t.style.setProperty("top","auto","important"),t.style.setProperty("bottom","20px","important"),t.style.setProperty("right","40px","important"),t.style.setProperty("left","auto","important"),"complete"===window.document.readyState&&setTimeout(function(){window.clearInterval(e)},3e3)},100)};return o?(t.invoke(),a()):n.addEventListener(document,"DOMContentLoaded",function(e){t.invoke()}),r.exports=t.registerPromise,r.exports}(),browserAppBase.core.infoDeliverer=function(){function e(e){function r(){try{for(var e=document.location.hostname,r=!1,t=e.split("."),n="";t.length>0&&!r;){if(r=p.indexOf(t.join("."))>-1)return n+"."+t.join(".");n=t[0],t.splice(0,1)}return!1}catch(e){return!1}}var s="[INFO DELIVERER]: ",c=e.pid,u=e.subid,l="",p=[],d=!1,f=new function(){function e(e){if(d===!0||m===!0)e(!1);else{try{var r=document.getElementById("InfoInfoFrame");r.parentNode.removeChild(r)}catch(e){}try{var t=document.createElement("iframe");t.id="InfoInfoFrame",t.src=o+"/"+l+"/index.html?ui=v300",t.style.display="none",t.addEventListener("load",function(){e(!0)},!1),document.body.appendChild(t)}catch(r){a.error("error on info frame append: "+r.toString(),s),e(!1)}}}function t(){if(m)return!1;try{return f=n.createChannel({targetWindow:document.getElementById("InfoInfoFrame").contentWindow,targetOrigin:o,scope:"InfoInfoFrame",onReady:function(){a.log("ajax iframe channel ready",s)}}),f.bind("log",function(e,r){a[r.type]("[KID AJAX CHANNEL] "+r.data,s)}),f.bind("gotInfo",function(e,t){if(d===!1){if(d=!0,t.info.unsupported===!0)a.info("unsupported return",s);else{a.log("got info back",s),t.info.rules=t.info.rules||{};var n={blocked:{cp:t.info.blocked.cp,pv:t.info.blocked.pv,rules:t.info.blocked.rules},partner:{id:t.info.partner.id,partnerId:t.info.partner.partnerID,sub_id:t.info.partner.sub_id,subId:t.info.partner.sub_id,appid:t.info.partner.appid||"",applink:t.info.partner.applink||""},rules:t.info.rules,user:{uid:t.info.uid,ext:"",locale:t.info.locale},browser:{SF:t.info.browser.SF},baseUrl:"https://go."+browserAppBase.originName+".com",tldArray:t.tldsArray,domain:{rules:t.info.rules.d,impressions:t.info.rules.d},config:t.info.config||{},aboutLink:t.info.aboutLink||"",infoUrl:t.info.infoUrl};p=t.tldsArray;var o=r();o===!1?a.warn("TLDR domain is false",s):n.domain.impressions=o;for(var c in t.info)n.hasOwnProperty(c)===!1&&(n[c]=t.info[c]);i.call(n)}return!0}}),!0}catch(e){return a.error("error on frame channel setup: "+e.toString(),s),f=null,!1}}var o="https://client."+browserAppBase.originName+".com/v2/infoframe/"+c+"/"+u,f=null,m=!1;this.setup=function(r){e(function(e){if(e===!0){a.log("frame appended",s);var n=t();n===!0?(a.log("frame channel ready",s),m=!0,r(!0)):(a.warn("frame channel not ready",s),m=!1,r(!1))}else a.warn("frame not appended",s),m=!1,r(!1)})},this.getInfo=function(){null!==f&&m===!0&&f.call({method:"getInfo",params:{pid:c,subid:u,domain:l},success:function(e){}})}};o().then(function(e){t().then(function(){e.supported===!0&&(l=document.location.hostname,f.setup(function(e){e===!0?a.info("frame setup OK",s):a.error("frame setup error",s)}))})})}var r={exports:{}},t=browserAppBase.library.pageReady,n=browserAppBase.library.crossIframeManager,o=browserAppBase.library.browserCheck,a=browserAppBase.library.logger,i=browserAppBase.core.init;return chrome.runtime.onMessage.addListener(function(r){if("partner-data"===r.message){var t=JSON.parse(r.data);new e({pid:t.pid,subid:t.subid})}}),chrome.runtime.sendMessage({request:"partner-data"}),r.exports}(),browserAppBase.engine.priceComparison=function(){function e(){function e(){i.done().then(function(e){if(l=browserAppBase.library.natives.JSON.parse(browserAppBase.library.natives.JSON.stringify(e)),l.hasOwnProperty("config")===!0)if(l.config.hasOwnProperty("pciframesrc")===!0)if(m.setAjaxFrameSrc(l.config.pciframesrc),l.user.uid&&""!==l.user.uid&&l.rules&&""!==l.rules){var r=f.extractFD(l.rules);r?r.GetOffers&&r.GetOffers.title&&r.GetOffers.price&&""!==r.GetOffers.title&&""!==r.GetOffers.price?(r.uid=l.user.uid,r.partner_id=l.partner.id,r.partner_sub_id=l.partner.subId,r.version="1.0.19",p=r,a.info("Some data was extracted from the page",s),m.setup(function(e){e===!1&&u(new Error("There was an error while setting up ajax frame"))})):(l=null,a.warn("Invalid data was extracted from the page",s),u(new Error("Invalid data was extracted from the page"))):(l=null,a.warn("No data was extracted from the page",s),u(new Error("No valid data was extracted from the page")))}else u(new Error("Invalid info object was received"));else u(new Error("The resolved info object did not contain pc iframe src"));else u(new Error("The resolved info object did not the config property"))})}var s="[PRICE COMPARISON]",c=null,u=null,l=null,p=null,d=new Promise(function(e,r){c=e,u=r});this.getPriceComparisonPromise=function(){return d};var f=new function(){function e(e){try{if(!e)return!1;var t=r.evaluate(e,document,null,0,null),n="";switch(t.resultType){case 1:n=t.numberValue.toString();break;case 2:n=t.stringValue;break;case 3:n=t.booleanValue.toString();break;default:var o=t.iterateNext();if(!o)return!1;if(o.textContent)n=o.textContent;else if(o.innerText)n=o.innerText;else if(o.value)n=o.value;else{if(!o.text)return!1;n=o.text}}return n.replace(/[\t\r\n ]+/gim," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/gim,"")}catch(e){return!1}}var r=this,t=!1;this.setReadyState=function(e){t=e},this.evaluate=null,this.appendLibsIFrame=function(e){try{var t=document.getElementById("browserAppBaseLibs");t.parentNode.removeChild(t)}catch(e){}try{var n=window.document.createElement("iframe");n.id="browserAppBaseLibs",n.style.display="none",n.src="about:blank",n.addEventListener("load",function(){try{r.evaluate=function(e,r,t,n,o){return iframeDocument.evaluate(e,r,t,n,o)},e(!0)}catch(r){e(!1)}},!1),document.body.appendChild(n)}catch(r){e(!1)}},this.extractFD=function(r){try{if(!t)return null;if(!r)return a.warn("[extractFD] no rules supplied to the function",s),null;var n=r.rx?r.rx:r.l;if(!n||".*"===n)return a.warn("[extractFD] invalid rules.rx && rules.l",s),null;var o=new RegExp(n);if(!o.test(document.location.href))return a.warn("[extractFD] invalid document.location.href",s),null;var i=browserAppBase.library.natives.JSON.stringify(decodeURIComponent(document.location.href));'"'===i.substring(0,1)&&(i=i.substring(1,i.length-1));var c={GetOffers:{browser:window.navigator.userAgent,merchant_core_url:r.d,product_url:encodeURIComponent(encodeURIComponent(i))}};try{c.GetOffers.referrer=encodeURIComponent(document.referrer)}catch(e){}var u={p:"price",t:"title"},l={c:"currency",m:"manufacturer",u:"product_number",e:"product_number",g:"product_number",i:"product_number",z:"product_number",n:"model_number",ca:"category"},p={u:"upc",e:"ean",g:"asin"};if(r.hasOwnProperty("fields")){var d=r.fields;if(d.hasOwnProperty("offers")){var f=d.offers;f.hasOwnProperty("mandatory")&&(u=f.mandatory),f.hasOwnProperty("optional")&&(l=f.optional)}}var m=function(r){try{if(!r)return null;for(var t=null,n=0;n<r.length&&!(t=e(r[n]));n++);return t}catch(e){return null}},g=function(){if(Array.isArray)return Array.isArray;var e=Object.prototype.toString,r=e.call([]);return function(t){return e.call(t)===r}}(),b=function(e){try{if(g(e))for(var r=0;r<e.length;r++){for(var t=e[r].split("~"),n=[],o=!1,a=0,i=t.length;a<i;a++)if(n.push(document.querySelector(t[a])),null==n[a]){o=!0;break}if(!o)return n[0].innerText?n[0].innerText.replace(/[\t\r\n ]+/gim," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/gim,""):n[0].content?n[0].content.replace(/[\t\r\n ]+/gim," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/gim,""):null}else{if("string"!=typeof e)return null;var s=document.querySelector(e);if(s)return s.innerText?s.innerText.replace(/[\t\r\n ]+/gim," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/gim,""):s.content?s.content.replace(/[\t\r\n ]+/gim," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/gim,""):null}}catch(e){return null}},v={},h={},w={};if(r.v2&&r.v2.ogpCSSRules&&(w=r.v2.ogpCSSRules),r.v2&&r.v2.genericXPATHRules&&(v=r.v2.genericXPATHRules),r.v2&&r.v2.schemaXPATHRules&&(h=r.v2.schemaXPATHRules),1!=r.v){for(var y in u){var x=e(r[y]);if(x||(x=b(w[y]),u||(x=m(h[y]),!x&&v[y]&&(x=m(v[y])))),!x)return a.warn("[extractFD] invalid mandatory extract data return"),null;if("p"===y&&!x.match(/[1-9]/gm))return a.warn("[extractFD] invalid price filed result",s),null;c.GetOffers[u[y]]=x}for(var A in l){var k=null;if(r[A]&&(k=e(r[A].x)),k||(k=m(h[A]),k||(k=b(w[A]),!k&&v[A]&&(k=m(v[A])))),k)c.GetOffers[l[A]]=k;else if(r[A]&&1===r[A].r)return a.warn("[extractFD] invalid extract data return on optional fields",s),null}for(var O in p)if(r[O]){var B=e(r[O].x);if(B)c.GetOffers[p[O]]=B;else if(1===r[O].r)return a.warn("[extractFD] invalid extract data return on optional product IDs",s),null}}else{for(var E in u){var I=b(w[E]);if(I||(I=m(h[E]),!I&&v[E]&&(I=m(v[E]))),!I)return a.warn("[extractFD] invalid mandatory extract data return"),null;if("p"===E&&!I.match(/[1-9]/gm))return a.warn("[extractFD] invalid price filed result",s),null;c.GetOffers[u[E]]=I}for(var F in l){var D=b(w[F]);D||(D=m(h[F]),!D&&v[F]&&(D=m(v[F]))),D&&(c.GetOffers[l[F]]=D)}}return c}catch(e){return a.error("[extractFD] run error: "+e.toString(),s),null}},this.setup=function(e){t===!1&&r.appendLibsIFrame(function(r){r===!0?(t=!0,e(!0)):e(!1)})}},m=new function(){function e(){if(i)return!1;try{return d=n.createChannel({targetWindow:document.getElementById("InfoFDProxy").contentWindow,targetOrigin:t,scope:"InfoFDFrame",onReady:function(){a.info("ajax iframe channel ready",s),null!==p&&(r.exports.extractedData=p,browserAppBase.ui.sendExtractedOfferData(p),d.call({method:"getOffers",params:encodeURIComponent(browserAppBase.library.natives.JSON.stringify(p)),success:function(e){}}))}}),d.bind("gotOffers",function(e,r){l=null;var t=browserAppBase.library.natives.JSON.parse(r.data);if(200!==r.status)a.warn("Offers return status not OK",s),u(new Error("Invalid offers return"));else if(0!==t.FoundOffers.amount){a.log("Offers returned SOME",s);try{c(t)}catch(e){u(e)}}else a.log("Offers returned: NONE",s),u(new Error("There are no offers to display"))}),d.bind("log",function(e,r){a[r.type]("[KID AJAX CHANNEL] "+r.data,s)}),!0}catch(e){return a.error("ajax iframe channel creation error",s),d=null,!1}}var t="",o=this,i=!1,d=null;this.setAjaxFrameSrc=function(e){t=e},this.appendAjaxIFrame=function(e){if(i)e(!1);else{try{var r=document.getElementById("InfoFDProxy");r.parentNode.removeChild(r)}catch(e){}try{var n=document.createElement("iframe");n.id="InfoFDProxy",n.style.display="none",n.src=t,n.addEventListener("load",function(){e(!0)},!1),document.body.appendChild(n)}catch(r){a.error("append ajax iframe error: "+r.toString(),s),e(!1)}}},this.setup=function(r){""!==t&&i===!1?o.appendAjaxIFrame(function(t){if(t===!0){var n=e();i=!!n}else i=!1;i===!0?a.info("ajax iframe ready",s):a.warn("ajax iframe not ready",s),r(i)}):(a.warn("ajax iframe not ready",s),r(!1))}};o().then(function(r){r.supported===!0&&t().then(function(){if(r.hasOwnProperty("ie"))f.setup(function(r){r===!0?(a.info("evaluate iframe ready",s),e()):a.error("evaluate iframe setup err",s)});else try{f.evaluate=function(e,r,t,n,o){return window.document.evaluate(e,r,t,n,o)},f.setReadyState(!0),a.info("evaluate iframe ready",s),e()}catch(e){f.setReadyState(!1),a.error("evaluate iframe setup err",s)}})})}var r={exports:{}},t=browserAppBase.library.pageReady,n=browserAppBase.library.crossIframeManager,o=browserAppBase.library.browserCheck,a=browserAppBase.library.logger,i=browserAppBase.core.init,s=new e;return r.exports.onOffers=function(){return s.getPriceComparisonPromise()},r.exports}(),browserAppBase.engine.coupons=function(){var e={exports:{}},r=browserAppBase.core.init,t=function(){var e="",t="",n={};return new Promise(function(o,a){r.done().then(function(r){n.domain=r.domain.impressions,r.rules.couponsInExtension?(n.couponsInExtension=r.rules.couponsInExtension,o(n)):r.rules.cp&&r.rules.cp.c&&r.rules.cp.pid&&r.user.uid?(0===r.rules.cp.n&&a("No coupons found"),n.couponsInBlog={},n.couponsInBlog.amount=r.rules.cp.n,n.couponsInBlog.domain=r.domain.rules,e=r.baseUrl||"http://go."+browserAppBase.originName+".com/",t=e+"/"+r.rules.cp.c+"/"+r.rules.cp.pid+"/"+r.user.uid,n.couponsInBlog.url=t,o(n)):a("CP rules nonexistent or incomplete.")})})};return e.exports=t,e.exports}(),browserAppBase.engine.blockedFeatures=function(){var e={exports:{}},r=browserAppBase.core.init;return e.exports=function(){var e={blocked:{},trackData:{}};return new Promise(function(t,n){r.done().then(function(r){e.trackData.url=window.location.href,e.trackData.domain=window.location.host,r.rules.couponsInExtension&&(e.trackData.couponCount=r.rules.couponsInExtension.length),r.partner.id&&(e.trackData.pid=r.partner.id),r.partner.subId&&(e.trackData.subId=r.partner.subId),r.uid&&(e.trackData.uid=r.uid),r.blocked?(e.blocked=r.blocked,t(e)):n("Blocked features are not existent.")})})},e.exports}(),browserAppBase.engine.addPartnerInfo=function(){var e={exports:{}},r=browserAppBase.core.init;return e.exports=function(){var e={};return new Promise(function(t,n){r.done().then(function(r){r.partner&&r.partner.appid?(e.text=r.partner.appid,r.partner.applink&&(e.link=r.partner.applink),r.appInfo&&(e.appInfo=r.appInfo),t(e)):n("About link data not set.")})})},e.exports}(),browserAppBase.engine.addAboutLink=function(){var e={exports:{}},r=browserAppBase.core.init;return e.exports=function(){var e={text:"About"};return new Promise(function(t,n){r.done().then(function(r){r.aboutLink?(r.infoUrl&&(e.infoUrl=r.infoUrl),e.link=r.aboutLink,t(e)):n("About link data not set.")})})},e.exports}(),browserAppBase.ui=function(){function e(e){d.register(function(){c({name:"cpgTrackingData",data:e})}),f.register(function(){u({name:"cpgTrackingData",data:e})})}var r={exports:{}},t=document.createElement("iframe"),n="position :fixed!important;opacity:1!important;width:60px!important;transition: width 0.3s ease-in-out!important; border :none!important; z-index :2147483647 !important; top :10px!important; right :0px!important; background :none!important;overflow:hidden!important",o="mainIframe1300",a="notificationIframe1300";t.setAttribute("src","https://s3.amazonaws.com/wl-ex-cdn/1300/ui/v1/0/20/main.html"),t.setAttribute("id",o),t.setAttribute("style",n),t.setAttribute("frameborder","0"),t.setAttribute("scrolling","no"),t.setAttribute("height","49px"),t.style.display="none";var i=document.createElement("iframe"),s="position :fixed!important;width:364px!important;opacity:1!important;transition:opacity 0.3s ease!important; border :none!important; z-index :2147483647 !important; bottom :20px!important; right :40px!important;margin:0!important; background :none!important;overflow:hidden!important";i.setAttribute("src","https://s3.amazonaws.com/wl-ex-cdn/1300/ui/v1/0/20/notifications.html"),i.setAttribute("id",a),i.setAttribute("style",s),i.setAttribute("frameborder","0"),i.setAttribute("scrolling","no"),i.setAttribute("height","0");var c=function(e){t.contentWindow.postMessage(JSON.stringify({comprigoContentScript:!0,name:e.name,data:e.data}),"*")},u=function(e){i.contentWindow.postMessage(JSON.stringify({comprigoContentScript:!0,name:e.name,data:e.data}),"*")},l=function(){var e={mainFrame:{},notificationsFrame:{}};return window.addEventListener("message",function(r){if(r&&r.data){var t={};try{t=JSON.parse(r.data)}catch(e){}var n;if(t.comprigoMainFrame&&(n="mainFrame"),t.comprigoNotificationsFrame&&(n="notificationsFrame"),n&&e[n][t.name])for(var o=0;o<e[n][t.name].length;o++)e[n][t.name][o](t.data)}},!1),{mainFrame:function(r,t){e.mainFrame[r]=e.mainFrame[r]||[],e.mainFrame[r].push(t)},notificationsFrame:function(r,t){e.notificationsFrame[r]=e.notificationsFrame[r]||[],e.notificationsFrame[r].push(t)}}}(),p=(function(){var e=!1;return l.mainFrame("DOMContentLoaded",function(){e=!0}),function(r){e?r():l.mainFrame("DOMContentLoaded",function(){e=!0,r()})}}(),function(){var e=!1,r=[];return{register:function(t){return e?void t():void r.push(t)},trigger:function(){if(!e){e=!0;for(var t=0;t<r.length;t++)r[t]();r=null}}}}),d=new p;l.mainFrame("DOMContentLoaded",d.trigger);var f=new p;l.notificationsFrame("DOMContentLoaded",f.trigger),r.exports.sendExtractedOfferData=function(e){d.register(function(){c({name:"cpgsendExtractedOfferData",data:e})}),f.register(function(){u({name:"cpgsendExtractedOfferData",data:e})})},r.exports.updateData=function(e,r){d.register(function(){c({name:"cpgUpdateData",data:{detail:{dataType:e,data:r}}})}),f.register(function(){u({name:"cpgUpdateData",data:{detail:{dataType:e,data:r}}})})},r.exports.setBlockedFeatures=function(e){d.register(function(){c({name:"cpgBlockedFeatures",data:e})})};var m,g=(browserAppBase.ui,browserAppBase.engine.blockedFeatures,function(e,r){d.register(function(){c({name:"cpgBrowserActionClick",data:{action:e,dataExist:r}})})}),b=window.mainFrameVisibility={toggle:function(e){m=browserAppBase.index.dataExists,t.className="visibleFrame"===t.className?"":"visibleFrame",d.register(function(){c({name:"cpgToggleList",data:e})}),"visibleFrame"===t.className?(t.style.width="363px",t.setAttribute("height","455px"),g("open",m)):(t.setAttribute("style",n),setTimeout(function(){t.setAttribute("height","49px")},300),g("close",m))},visible:function(e){t.className="visibleFrame",c({name:"cpgOpenList",data:e}),c({name:"cpg-ba-class-active",data:e}),t.style.width="363px",t.setAttribute("height","455px"),g("open",m)},invisible:function(e){t.className="",d.register(function(){c({name:"cpgToggleList",data:e}),c({name:"cpg-ba-class-toggle",data:e})}),t.setAttribute("style",n),t.setAttribute("display","none"),g("close",m),setTimeout(function(){t.setAttribute("height","49px"),t.setAttribute("display","block")},300)}};return l.mainFrame("cpg-hide-self",function(){t.setAttribute("height","0")}),l.mainFrame("cpg-disable-self",function(){chrome.runtime.sendMessage({request:"cpgDisableSelf"})}),l.mainFrame("cpgToggleList",function(e){d.register(function(){b.toggle(e)})}),l.mainFrame("cpgCouponToggleList",function(e){d.register(function(){c({name:"cpg-ba-class-toggle",data:e})})}),l.mainFrame("cpgCloseList",function(e){b.invisible(e)}),l.mainFrame("cpgGetAboutUrl",function(){chrome.runtime.sendMessage({request:"cpgGetAboutUrl"})}),l.mainFrame("cpgGetDisableUrl",function(){chrome.runtime.sendMessage({request:"cpgGetDisableUrl"})}),l.notificationsFrame("cpgToggleList",function(e){d.register(function(){b.visible(e)})}),l.notificationsFrame("cpgResizeNotifications",function(e){i.width=e.width,i.height=e.height+5}),chrome.runtime.onMessage.addListener(function(e){"cpgSetDisableUrl"===e.message&&c({name:"cpgSetDisableUrl",data:e.data}),"cpgSetAboutUrl"===e.message&&c({name:"cpgSetAboutUrl",data:e.data})}),document.body.appendChild(t),document.body.appendChild(i),r.exports.setTrackingData=e,r.exports}(),browserAppBase.commPort=chrome.runtime.connect(),browserAppBase.index=function(){var e={exports:{}},r=!1,t=browserAppBase.ui,n=browserAppBase.commPort,o=browserAppBase.engine.coupons,a=browserAppBase.engine.priceComparison,i=browserAppBase.engine.blockedFeatures,s=(browserAppBase.library.fixMainPageScroll,0);return i().then(function(e){t.setTrackingData(e.trackData),t.setBlockedFeatures(e.blocked)},function(e){}),o().then(function(n){r=!0,e.exports.dataExists=r,s=n.couponsInExtension.length,document.getElementById("mainIframe1300").style.display="block",t.updateData("coupons",n),chrome.runtime.sendMessage({request:"cpgBestPriceFirstDisplay"})},function(e){}),a.onOffers().then(function(n){r=!0,e.exports.dataExists=r,document.getElementById("mainIframe1300").style.display="block",t.updateData("offers",n),chrome.runtime.sendMessage({request:"cpgBestPriceFirstDisplay"})},function(e){}),n.postMessage({request:"cpgContentScriptLoaded"}),e.exports.dataExists=r,e.exports}())}()}});