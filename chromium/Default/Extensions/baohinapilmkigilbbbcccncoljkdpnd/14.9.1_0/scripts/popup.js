var _gaq=_gaq||[];!function(){"use strict";function e(){if("true"!==localStorage.getItem("disableAnalytics")&&"baohinapilmkigilbbbcccncoljkdpnd"===chrome.runtime.id){_gaq.push(["_setAccount","UA-38514239-1"]),_gaq.push(["_trackPageview"]),_gaq.push(["_trackEvent","Extension Opened","load"]);var e=document.createElement("script");e.async=!0,e.src="https://ssl.google-analytics.com/ga.js";var t=document.querySelector("script");t.parentNode.insertBefore(e,t)}}function t(){return new Promise(function(e){chrome.tabs.executeScript({code:"window.getSelection().toString();"},function(t){var n="";Array.isArray(t)&&"string"==typeof t[0]&&(n=t[0]),e(n)})})}function n(){return Promise.all([cjExtensions.getCurrentTab(),t()]).then(function(e){var t=e[0],n=e[1],a="";return""!==n&&(a+=n+"\n\n"),a+=t.url,cjBasics.urls.create("https://mail.google.com/mail/",{ui:"2",view:"cm",tf:"0",su:t.title,body:a})})}function a(){return cjExtensions.getCurrentTab().then(function(e){return cjBasics.urls.create("https://www.google.com/bookmarks/mark",{op:"add",bkmk:e.url,title:e.title})})}function r(){return t().then(function(e){return cjBasics.urls.create("https://www.google.com/maps",{q:e.replace(/\n|\r\n|\r/g,", ").replace(/ /g,"+")})})}function i(){cjExtensions.getCurrentTab().then(function(e){document.getElementById("special-shortcut-container").textContent="";var t=document.createElement("div");t.textContent="loading...",t.className="g-plusone",t.dataset.annotation="inline",t.dataset.width="350",t.dataset.href=e.url,document.getElementById("special-shortcut-container").appendChild(t);var n=document.createElement("script");n.async=!0,n.src="https://plus.google.com/js/plusone.js",document.head.appendChild(n)})}function s(){cjExtensions.getCurrentTab().then(function(e){document.getElementById("special-shortcut-container").innerHTML='<center><img style="height: 16px; width: 16px; margin: 2px;" src="images/16/goo_gl_16dp.svg"/>&nbsp;<input type="text" id="short" value="loading..." style="margin-bottom:10px;"/></center>';var t=document.getElementById("short");t.addEventListener("click",function(){t.select()}),cjBasics.ajax({url:cjBasics.urls.create("https://www.googleapis.com/urlshortener/v1/url",{key:"AIzaSyBiZYqhpRmNUArKPpqk7Wj15NIArVRmS6k"}),type:"POST",dataType:"JSON",data:JSON.stringify({longUrl:e.url}),requestHeaders:{"content-type":"application/json"}}).then(function(e){t.value=e.id,t.click(),document.execCommand("copy",!1,null)},function(){t.value="Oops. Error."})})}function c(e){var t=-1!==badgeOnLeftIcons.indexOf(e.icon),n=64===e.size?"64px":"32px",a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("viewBox","0 0 32 32"),a.setAttribute("class","cj-al-badge"),a.style.height=n,a.style.width=n;var r=document.createElementNS("http://www.w3.org/2000/svg","g");16===e.size?r.setAttribute("transform","translate("+(t?"6":"17")+", 17) scale(.5)"):r.setAttribute("transform","translate("+(t?"1":"21")+", 21) scale(.5)"),a.appendChild(r);var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M10,21.1421356 C15.5228475,21.1421356 20,16.6649831 20,11.1421356 C20,5.61928813 0,5.61928813 0,11.1421356 C0,16.6649831 4.4771525,21.1421356 10,21.1421356 Z"),i.setAttribute("fill","rgba(0,0,0,.1)"),r.appendChild(i);var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d","M20,10 C20,15.5228 15.5228,20 10,20 C4.47715,20 0,15.5228 0,10 C0,4.47715 4.47715,0 10,0 C15.5228,0 20,4.47715 20,10 Z"),s.setAttribute("fill","#f5f5f5"),r.appendChild(s);var c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("d",serviceBadges[e.badge]),c.setAttribute("fill","rgba(0,0,0,.54)"),r.appendChild(c),a}function o(e,t){var n=document.createElement("span");n.className="service-icon";var a=document.createElement("img"),r=e.custom&&!e.iconUrl?16:t,i=16===r?16:32;if(e.badge&&e.badge in serviceBadges){var s=c({badge:e.badge,size:r,icon:e.icon});n.appendChild(s)}return e.custom&&16!==r&&a.addEventListener("load",function o(){a.height<=t*(7/8)&&n.classList.add("service-icon-box"),a.removeEventListener("load",o)}),a.height=r,a.width=r,e.custom?a.src=e.iconUrl||"https://www.google.com/s2/favicons?domain_url="+encodeURIComponent(e.url):a.src="/images/"+i+"/"+(e.icon||"placeholder")+"_"+i+"dp.svg",n.appendChild(a),n}function l(e){var t=e;b&&(t=cjBasics.urls.insertParameter(t,"authuser",v)),w?chrome.tabs.create({url:t,active:!f.noFocusTab}):cjExtensions.getCurrentTab().then(function(e){chrome.tabs.update(e.id,{url:t})}),window.close()}function d(){l(chrome.runtime.getURL("options.html?standalone=1"))}function u(e){_gaq.push(["_trackEvent","Open service",e.toString(),servicesDatabase[e].name]);var t=servicesDatabase[e],c={177:i,178:s};if(e in c)return void c[e]();if(-1===e)return void d();var o={172:a,175:n,176:r};return e in o?void o[e]().then(l):void l(t.url)}function h(e,t){if(y&&t)return t;var n=chrome.i18n.getMessage(e);return""===n?t||"placeholder":n}function m(){var e=document.getElementById("service-container"),t=document.createElement("div");t.className="app-bar";var n=document.createElement("input");n.className="launchbox",n.type="search",n.autofocus=!0,n.placeholder="Filter shortcuts, hit enter to launch the first shortcut in the list",n.addEventListener("input",function(){for(var t=n.value.toLowerCase(),a=e.children,r=0;r<a.length;r++){var i=a[r];i.classList.toggle("hide",-1===i.dataset.label.toLowerCase().indexOf(t))}}),n.addEventListener("search",function(){var e=document.querySelector("#service-container > :not(.hide)");e&&u(parseInt(e.dataset.service,10))}),t.appendChild(n);var a=document.createElement("div");a.className="settings-button",a.addEventListener("click",d),t.appendChild(a),e.parentNode.insertBefore(t,e)}function p(){e();var t=document.getElementById("service-container");E.then(function(){f.showSettings&&!f.showLaunchbox&&(g.push(-1),servicesDatabase[-1]=settingsData),f.hideLabel||document.body.classList.add("show-labels");var e=f.shortcutIconSize?parseInt(f.shortcutIconSize,10):64;document.body.classList.add("icon-size-"+e);var n=document.createDocumentFragment();g.forEach(function(t){if(t in servicesDatabase){var a=servicesDatabase[t],r=h(a.i18n,a.name),i=document.createElement("div");i.className="service-item",i.dataset.service=t,i.dataset.label=r,f.hideTooltip||i.setAttribute("title",r);var s=o(a,e);if(i.appendChild(s),!f.hideLabel){var c=document.createElement("p");c.className="service-name",c.textContent=r,i.appendChild(c),setTimeout(function(){64===e&&88===c.offsetWidth&&i.classList.add("long")},1e3)}n.appendChild(i)}}),t.appendChild(n);var a,r,i,s,c=t.children.length,l=f.displayMode||"grid";if(f.hideLabel||64===e){if(r={16:24,32:44,64:88}[e],i={16:24,32:44,64:100}[e],s=Math.floor(768/r),"grid"===l){var d=Math.round(Math.sqrt(c)+.49);a=d>=s?s:1>d?1:d*d-1===c?d+1:d}"vertical"===l&&(a=1),"horizontal"===l&&(a=s>c?c:s),"custom"===l&&(a=f.iconBreak>s?s:f.iconBreak)}else{if(r=192,s=4,"grid"===l){i={16:24,32:44}[e];var d=Math.round(i*c/r);a=d>=s?s:1>d?1:d}"vertical"===l&&(a=1),"horizontal"===l&&(a=s>c?c:s),"custom"===l&&(a=f.iconBreak>s?s:f.iconBreak)}var u=Math.ceil(c/a),p=a*r+16,v=u*i+16;t.width=p,t.height=v,t.style="width: "+p+"px; height: "+v+"px;",f.showLaunchbox&&m()})}var g,v,f,b=!1,w=!0,E=new Promise(function(e){cjExtensions.settings.get(["alwaysTab","noFocusTab","shortcutIconSize","customServicesDatabase","iconBreak","hideTooltip","userList","hideLabel","displayMode","showSettings","showLaunchbox"]).then(function(t){f=t&&Array.isArray(t.userList)?t:defaultSettings;var n=f.customServicesDatabase;Object.keys(n).forEach(function(e){servicesDatabase[e]=n[e],servicesDatabase[e].custom=!0}),w=f.alwaysTab,g=f.userList,e()})}),y="en"===cjBasics.lang.split("-")[0];window.addEventListener("load",p),window.addEventListener("mouseup",function(e){var t=e.target.dataset.service;t&&u(parseInt(t,10))})}();