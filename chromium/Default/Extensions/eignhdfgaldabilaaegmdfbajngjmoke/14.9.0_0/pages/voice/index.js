cjModules.define(function(){"use strict";return function(e,t){function a(e){var t=cjBasics.urls.create(p+"search",{from:"[]",hl:g.lang,q:JSON.stringify(e.split(" "))});bmBasics.openTab(t)}function n(e){var t=e||{},a={authuser:g.account.authuser,hl:g.lang};"undefined"!=typeof t.number?(a.hip=t.number,a.hpn=t.number):a.hip="";var n="https://plus.google.com/hangouts/_/",r=cjBasics.urls.create(n,a);bmBasics.openTab(r)}function r(){return cjBasics.ajax({url:h+"request/user?hl="+g.lang,dataType:"JSON"}).then(function(e){var t=e&&e.formattedCredit;if(t)return t;throw Error()},function(){throw Error()})}function i(){return cjBasics.ajax({url:h+"inbox/recent/all/?hl="+g.lang,dataType:"XML"}).then(function(e){if(!e)throw Error();var t=e.querySelector("json");if(!t)throw Error();var a=t.textContent;if(!a)throw Error();var n=a.replace("<![CDATA[","").replace("]]>","");if(!n)throw Error();var r;try{r=JSON.parse(n)}catch(i){throw Error(i)}var c=r&&r.messages;if(!c)throw Error();return c},function(){throw Error()})}function c(e){return 2===e?b.voicemail:10===e||11===e?b.sms:0===e?b.missed:1===e||9===e?b.received:b.placed}function l(){var e=cjMaterial.createElement("container",{scrollable:!0,shadow:!0,darker:!0});return bmBasics.toggleLoading("on",e),i().then(function(t){Object.keys(t).forEach(function(a){var r=t[a];if(!r.isTrash&&!r.isSpam){var i=cjMaterial.createElement("card",{withPadding:!0}),l=cjMaterial.createElement("title",{label:r.displayNumber});i.appendChild(l);var o=c(r.type),s=cjMaterial.createElement("icon",o);s.classList.add("call-icon"),i.appendChild(s);var d=document.createElement("p");d.textContent=r.displayStartDateTime,i.appendChild(d);var m=cjMaterial.createElement("secondarytext",{label:r.relativeStartTime});i.appendChild(m);var u=cjMaterial.createElement("button",{label:cjExtensions.i18n("cj_i18n_00213","Call")});u.classList.add("call-button"),u.addEventListener("click",function(){n({number:r.phoneNumber})}),i.appendChild(u),e.appendChild(i)}})},function(){var t=cjMaterial.createElement("emptystate",{color:"#4285f4",label:cjExtensions.i18n("cj_i18n_00394","No recent calls"),iconName:"__mdi:call"});e.appendChild(t)}).then(function(){bmBasics.toggleLoading("off",e)}),e}function o(){var e=cjMaterial.createElement("container",{scrollable:!0,shadow:!0,darker:!0});return bmBasics.toggleLoading("on",e),r().then(function(t){var a=cjMaterial.createElement("card",{withPadding:!0}),n=cjMaterial.createElement("title",{label:"Credit: "});a.appendChild(n);var r=document.createElement("span");r.className="credits",r.textContent=t,n.appendChild(r);var i=cjMaterial.createElement("button",{label:cjExtensions.i18n("cj_i18n_00395","Add credits")});i.addEventListener("click",function(){bmBasics.openTab(h+"#billing")}),a.appendChild(i),e.appendChild(a),bmBasics.toggleLoading("off",e)},function(){var t=cjMaterial.createElement("card",{withPadding:!0});t.textContent=cjExtensions.i18n("cj_i18n_00396","Couldn't fetch your google voice credits. Are you use google voice is enabled for your account?"),e.appendChild(t),bmBasics.toggleLoading("off",e)}),e}function s(){m={callHistory:{label:cjExtensions.i18n("cj_i18n_00397","Call history"),content:l},credits:{label:cjExtensions.i18n("cj_i18n_00398","Credits"),content:o}};var n=bmElements.createElement("pageheader",{color:"#4285f4",pageId:"voice",searchboxProperties:{onSubmit:a,submitInNewTab:!0}});e.appendChild(n),u(n.searchbox.select);var r=cjMaterial.createElement("appbar",{color:"#4285f4",secondary:!0}),i=cjMaterial.createElement("tabs",{fill:!0,items:m,onChange:function(e){d.selected=e},selected:f});r.appendChild(i),e.appendChild(r),d=bmElements.createElement("multiplecontainer",{items:m,selected:f}),e.appendChild(d),t.setOpenInNewHandler(function(){var e=p+"calls";"credits"===d.selected&&(e=h+"#billing"),bmBasics.openTab(e)})}var d,m,u=t.onPageDisplay,p="https://voice.google.com/u/"+g.account.authuser+"/",h="https://www.google.com/voice/b/"+g.account.authuser+"/",f="callHistory",b={voicemail:{name:"__mdi:voicemail"},sms:{name:"__mdi:textsms"},missed:{name:"__mdi:call_missed",color:"#ea4335"},received:{name:"__mdi:call_received",color:"#34a853"},placed:{name:"__mdi:call_made",color:"#4285f4"}};s()}});