cjModules.define(function(){"use strict";return function(e,n){function t(e){for(var n=bmElements.createElement("maintoolbarbuttons","gplus"),t=0;t<bmBasics.getMainToolbarButtonCount();t++)n.children[t].classList.add("hide-initially");e.appendChild(n)}function a(){e.classList.add("search"),B.searchbox.focus()}function i(e,n){g.modules.load("plusone").then(function(){gapi.plusone.render(e,{width:336,bm_contentscript:"commentsplusone",annotation:"inline",href:n,hl:g.lang})})}function o(e){var n=cjMaterial.createElement("card",{withPadding:!0});n.classList.add("plusone-card");var t=document.createElement("div");t.className="plusone-title";var a;a=e.favicon?cjMaterial.createElement("icon",{url:e.favicon}):cjMaterial.createElement("icon",{favicon:e.url}),t.appendChild(a);var o=document.createElement("h3");o.textContent=e.label,t.appendChild(o),n.appendChild(t);var c=document.createElement("div");return n.appendChild(c),i(c,e.url),n}function c(e){var n=L;n.textContent="";var t=cjMaterial.createElement("emptystate",{color:A,iconName:"__mdi:share",label:"Can't share page",subLabel:e});n.appendChild(t)}function l(e){return cjBasics.urls.create(Y+"_/notifications/mobile",{hl:g.lang,bm_contentscript:"sharebox",url:e})}function r(e){k.selected="sharebox",k.pages.sharebox.iframe.src=l(e)}function s(e,n){g.modules.load("comments").then(function(){gapi.comments.render(e,{href:n.url,width:384,first_party_property:"BLOGGER",view_type:"FILTERED_POSTMOD",bm_contentscript:"comments",authuser:g.account.authuser,pageId:g.account.pageid,hl:g.lang})})}function m(e){var n=L,t=o(e);n.appendChild(t);var a=cjMaterial.createElement("subheader",{label:cjExtensions.i18n("cj_i18n_00325","Loading...")});n.appendChild(a);var i=cjMaterial.createElement("card");i.classList.add("comments-card");var c=document.createElement("div");i.appendChild(c),n.appendChild(i),s(c,e),window.addEventListener("message",function(){var e=event.data.blackMenuShareAction;"undefined"!=typeof e&&r(e);var t=event.data.blackMenuGplusCommentsCount;if("undefined"!=typeof t){var o="";0===t?(o=cjExtensions.i18n("cj_i18n_00326","Nobody shared this page yet"),n.removeChild(i)):(o=t,o=1===t?t+" "+cjExtensions.i18n("",cjExtensions.i18n("cj_i18n_00328","others shared this page")):cjExtensions.i18n("cj_i18n_00327","One other shared this page"),i.classList.add("on")),a.textContent=o}},!1)}function d(){var e=cjMaterial.createElement("container",{darker:!0}),n=cjMaterial.createElement("appbar",{secondary:!0});if(bmRuntime.xFrameOptionsSupported){var i=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){y.open()}});n.appendChild(i)}var o=cjMaterial.createElement("title",{label:cjExtensions.i18n("cj_i18n_00297","Share this page")});n.appendChild(o);var l=cjMaterial.createElement("iconbutton",{iconName:"__mdi:search",onClick:a});l.classList.add("hide-initially"),n.appendChild(l),t(n),e.appendChild(n);var r=cjMaterial.createElement("fab",{label:cjExtensions.i18n("cj_i18n_00329","New post"),iconName:"__mdi:create",onClick:function(){k.selected="sharebox",k.pages.sharebox.iframe.reload()}});return e.appendChild(r),L=cjMaterial.createElement("container",{scrollable:!0,shadow:!0}),e.appendChild(L),cjExtensions.getCurrentTab().then(function(e){var n=e.url;if(n){if(-1!==n.indexOf("http://")||-1!==n.indexOf("https://"))return void m(e);c(cjExtensions.i18n("cj_i18n_00330","You can only share normal webpages"))}}),e}function u(e){bmBasics.openTab(Y+"s/"+e)}function p(e){G!==e&&(G=e,W.then(function(){G===e&&S.sendMessage({method:"clickEle",parameters:{selector:K[e].navigationItemSelector}})}))}function b(n){D?e.classList.remove("search"):D=!0;var t=-1!==H.indexOf(n),a=K[n];t?(k.selected="website",p(n),T.textContent=a.label):k.selected=n}function h(){var e=cjMaterial.createElement("drawer",{color:"#ea4335"}),n=bmElements.createElement("servicelogo",{label:"+"});return e.appendChild(n),N=bmElements.createElement("drawertabs",{items:K,onChange:b,selected:F}),e.appendChild(N),e}function f(){var e="gplus-"+Date.now();bmBasics.onRequestReceived(e).then(function(e){bmBasics.openTab(e.split("?")[0])}),S.sendMessage({requestId:e,method:"getUrl"})}function _(){return cjBasics.ajax({url:z+"up/"}).then(function(e){return-1!==e.indexOf("up/accounts/upgrade")?"disabled":-1!==e.indexOf("<title>Google</title>")?"disabledAdministrator":"enabled"})}function v(){var e="";if(!N)return e;var n=N.selected;if(-1===H.indexOf(n))return e;var t=K[n].websitePath;return"string"==typeof t?t:e}function j(e){return cjBasics.urls.create(Y+v(),{bm_contentscript:"plus",bm_gplus_use_beta:"1",bm_embed:"1",bm_fix_embed:"1",bm_namespace:"social_PlusAppUi",bm_instance:Date.now(),bm_functionnames:e,hl:g.lang})}function E(){var e=document.createDocumentFragment(),n=document.createElement("div");n.className="cj-md-subheader",n.textContent="Type",e.appendChild(n);var t=[{label:cjExtensions.i18n("cj_i18n_00331","Everything"),value:"/top"},{label:cjExtensions.i18n("cj_i18n_00292","Collections"),value:"/collections"},{label:cjExtensions.i18n("cj_i18n_00293","Communities"),value:"/communities"},{label:cjExtensions.i18n("cj_i18n_00334","People and pages"),value:"/people"}];return t.forEach(function(n){var t=cjMaterial.createElement("item");t.textContent=n.label,t.addEventListener("click",function(){var e=B.searchbox.value;e.length>0&&bmBasics.openTab(Y+"s/"+e+n.value)}),e.appendChild(t)}),e}function C(){var e=cjMaterial.createElement("container"),n=cjMaterial.createElement("appbar",{secondary:!0});P=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){O?S.sendMessage({method:"back"}):y.open()}}),n.appendChild(P),T=cjMaterial.createElement("title",{label:cjExtensions.i18n("cj_i18n_00291","Home")}),n.appendChild(T);var i=cjMaterial.createElement("iconbutton",{iconName:"__mdi:search",onClick:a});return i.classList.add("hide-initially"),n.appendChild(i),t(n),e.appendChild(n),gFunctionNames.get({cacheName:"function-names-gplus",fallback:"yc,nc,qc,oc",refreshUrl:"https://plus.google.com/?bm_gplus_use_beta=1"}).then(function(n){S=bmElements.createElement("iframe",{darker:!0,src:j(n.functionNames),noLoading:!0});var t=0;S.iframeElement.addEventListener("load",function(){10>t&&S.iframeElement.contentWindow.location.href.startsWith("about:")&&(t++,setTimeout(function(){S.src=S.src.replace("bm_instance=","bm_instance=a")},100))}),e.appendChild(S),n.refreshPromise.then(function(e){t=0,S.src=j(e)})}),e}function x(){var e=cjMaterial.createElement("container"),n=cjMaterial.createElement("appbar",{secondary:!0,light:!0}),t=cjMaterial.createElement("iconbutton",{iconName:"__mdi:arrow_back",onClick:function(){k.selected="comments"}});n.appendChild(t);var a=cjMaterial.createElement("title",{label:cjExtensions.i18n("cj_i18n_00329","New post")});return n.appendChild(a),e.appendChild(n),e.iframe=bmElements.createElement("iframe",{src:l()}),e.appendChild(e.iframe),e}function w(n){for(var t=e.querySelectorAll("div:not(.bm-ele-fulldialog) > .cj-md-appbar"),a=0;a<t.length;a++){var i=t[a];i.setAttribute("style","background-color: "+n),i.classList.toggle("cj-md--dark",!n.startsWith("#fff"))}}function M(){n.setOpenInNewHandler(function(){"website"===k.selected?f():bmBasics.openTab(Y)}),J={comments:{color:A,content:d},website:{color:A,content:C,loadOnInit:!0},sharebox:{color:"#fff",content:x}},bmRuntime.xFrameOptionsSupported||delete J.website;var t=0;k=bmElements.createElement("multiplecontainer",{items:J,selected:U||!bmRuntime.xFrameOptionsSupported?"comments":"website",onChange:function(n){w(J[n].color),t++,t>2&&e.classList.remove("search")}}),e.classList.add("search"),_().then(function(n){if("enabled"!==n){var t,a,i;"disabled"===n&&(t=cjExtensions.i18n("cj_i18n_00335","The current account isn't yet signed up to Google+"),a=cjExtensions.i18n("cj_i18n_00337","Sign up"),i=function(){bmBasics.openTab("https://plus.google.com/u/"+g.account.authuser+"/up/")}),"disabledAdministrator"===n&&(t=cjExtensions.i18n("cj_i18n_00336","Google+ is not available for your organization. Please contact your administrator to enable this service for at least one user in the organization."),a=cjExtensions.i18n("cj_i18n_00234","Change account"),i=function(){setTimeout(function(){document.querySelector(".account-switcher>.account-item").click()})}),e.textContent="";var o=bmElements.createElement("fulldialog",{serviceLogo:{label:"+"},iconName:"gplus",message:t,actionLabel:a,action:i});e.appendChild(o)}}),chrome.runtime.onMessage.addListener(function(e){e.closeSharebox&&(k.selected=N.selected)}),B=bmElements.createElement("pageheader",{pageId:"gplus",searchboxProperties:{onSubmit:u,onClear:function(){e.classList.remove("search"),B.searchmenu.hide()},submitInNewTab:!0},includeSearchMenu:!0}),B.classList.add("gplus-top-appbar");var a=E();B.searchmenu.appendChild(a),bmRuntime.xFrameOptionsSupported&&(y=h()),e.appendChild(B),R(B.searchbox.select),e.appendChild(k),bmRuntime.xFrameOptionsSupported&&e.appendChild(y),b(F);var i;window.addEventListener("message",function(e){var n=e.data;if(n&&"gplusWebsiteData"!==!n.method&&("view"===n.key&&q===!1&&(q=!0,I()),"website"===k.selected)){if("title"===n.key)return void("back"===i&&(T.textContent=n.value));if("view"===n.key)return i=n.value,N.selected=i,O="back"===i,void P.updateIcon({iconName:O?"__mdi:arrow_back":"__mdi:menu"});if("color"===n.key){var t=n.value;return J.website.color=t,void w(t)}}})}var y,N,k,L,S,T,P,O,I,B,R=n.onPageDisplay,U=bmRuntime.runningInExtensionPopup,F=U||!bmRuntime.xFrameOptionsSupported?"comments":"stream",D=!1,A="#ea4335",G="stream",q=!1,W=new Promise(function(e){I=e}),H=["stream","communities","collections","profile","people","notifications","settings"],z="https://plus.google.com/u/"+g.account.authuser+"/",Y=z;g.account.pageid&&"none"!==g.account.pageid&&(Y+="b/"+g.account.pageid+"/");var J,K={stream:{label:cjExtensions.i18n("cj_i18n_00291","Home"),iconName:"__mdi:home",navigationItemSelector:"[role='navigation'] [href='./']",websitePath:"",newTabUrl:Y+"stream"},collections:{color:"#03a9f4",label:cjExtensions.i18n("cj_i18n_00292","Collections"),iconName:"__mdi:cj_google_collections",navigationItemSelector:"[role='navigation'] [href^='./collections/']",websitePath:"collections/featured",newTabUrl:Y+"collections"},communities:{color:"#0f9d58",label:cjExtensions.i18n("cj_i18n_00293","Communities"),iconName:"__mdi:communities",navigationItemSelector:"[role='navigation'] [href^='./communities/']",websitePath:"communities",newTabUrl:Y+"communities"},profile:{color:"#4285f4",label:cjExtensions.i18n("cj_i18n_00294","Profile"),navigationItemSelector:"[role='navigation'] [href^='./"+g.account.userid+"']",websitePath:g.account.userid,iconName:"__mdi:account_circle",newTabUrl:Y+"me"},people:{color:"#4285f4",label:cjExtensions.i18n("cj_i18n_00295","People"),navigationItemSelector:"[role='navigation'] [href^='./circles'], [role='navigation'] [href^='./people']",websitePath:"people",iconName:"__mdi:people",newTabUrl:Y+"people"},notifications:{label:cjExtensions.i18n("cj_i18n_00296","Notifications"),navigationItemSelector:"[role='navigation'] [href^='./notifications/all']",websitePath:"notifications/all",iconName:"__mdi:notifications",newTabUrl:Y+"notifications/all"},comments:{label:cjExtensions.i18n("cj_i18n_00297","Share this page"),iconName:"__mdi:share",divider:!0},settings:{color:"#4285f4",label:cjExtensions.i18n("cj_i18n_00298","Settings"),navigationItemSelector:"[role='navigation'] [href^='./settings']",websitePath:"settings",iconName:"__mdi:settings",newTabUrl:Y+"settings"}};U||delete K.comments,M()}});