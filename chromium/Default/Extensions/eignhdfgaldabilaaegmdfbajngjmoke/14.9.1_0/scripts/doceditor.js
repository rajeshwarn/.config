cjModules.define(function(){"use strict";return function(e){return function(i,n){function t(e){var i=e.webViewLink;i=cjBasics.urls.insertParameter(i,"authuser",g.account.authuser,!1),bmBasics.openTab(i)}function o(){r.textContent="";var n=["trashed = false",j];x[v]&&n.push(x[v]),h&&(b=d.value,n.push("name contains '"+b+"'")),C.then(function(){bmBasics.toggleLoading("off",i);var o=gDoclist.create({listview:y,onFileClick:t,entityName:e.entityName,emptyStateIcon:e.emptyStateIcon,primaryColor:e.primaryColor,searching:h,cachingId:h?null:"bm__cache__"+w+"__doclist",spaces:"drive",orderBy:T[f],q:n.join(" and ")});r.appendChild(o)})}function a(i){h=i,m.textContent=i?"Search":e.serviceName,u.updateIcon({iconName:i?"__mdi:arrow_back":"__mdi:menu"}),i===!1&&(d.value=""),o()}function c(){var i=cjMaterial.createElement("appbar",{secondary:!0,color:e.primaryColor,light:e.lightTheme});u=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){h?a(!1):p.open()}}),i.appendChild(u),m=cjMaterial.createElement("title",{label:e.serviceName}),i.appendChild(m);var n=bmElements.createElement("dropdown",{selected:v,onChange:function(e){v=e,cjExtensions.settings.set(E+"FilterBy",e),o(),n.close()},items:[{id:"all",label:cjExtensions.i18n("cj_i18n_00107","All")},{id:"owned",label:cjExtensions.i18n("cj_i18n_00108","Owned by me")},{id:"shared",label:cjExtensions.i18n("cj_i18n_00109","Shared with me")}]}),t=cjMaterial.createElement("iconbutton",{label:cjExtensions.i18n("cj_i18n_00110","Filter"),iconName:"__mdi:filter_list",onClick:function(){n.open()}});i.appendChild(t),t.addEventListener("click",function(e){e.stopPropagation()}),i.appendChild(n);var c=bmElements.createElement("dropdown",{selected:f,onChange:function(e){f=e,cjExtensions.settings.set(E+"OrderBy",e),o(),c.close()},items:[{id:"name",label:cjExtensions.i18n("cj_i18n_00092","Name")},{id:"modifiedTime desc",label:cjExtensions.i18n("cj_i18n_00093","Last modified")},{id:"modifiedByMeTime desc",label:cjExtensions.i18n("cj_i18n_00094","Last modified by me")},{id:"viewedByMeTime desc",label:cjExtensions.i18n("cj_i18n_00095","Last opened by me")}]}),s=cjMaterial.createElement("iconbutton",{label:cjExtensions.i18n("cj_i18n_00096","Order by"),iconName:"__mdi:cj_sort_by_alpha",onClick:function(){c.open()}});i.appendChild(s),s.addEventListener("click",function(e){e.stopPropagation()}),i.appendChild(c);var l=cjMaterial.createElement("iconbutton",{label:cjExtensions.i18n("cj_i18n_00106","Change view"),iconName:y?"__mdi:view_module":"__mdi:view_list",onClick:function(){y=!y,l.updateIcon({iconName:y?"__mdi:view_module":"__mdi:view_list"}),cjExtensions.settings.set(E+"ThumbnailView",!y),o()}});return i.appendChild(l),i}function s(){var i=cjMaterial.createElement("drawer"),n=bmElements.createElement("servicelogo",{label:e.serviceName,color:e.primaryColor});i.appendChild(n);var t=bmElements.createElement("drawertabs",{items:N,onChange:function(e){bmRuntime.changeToPage(e),t.selected=w},selected:w});return i.appendChild(t),i}function l(){bmBasics.toggleLoading("on",i);var n=bmElements.createElement("pageheader",{color:e.primaryColor,pageId:w,light:e.lightTheme,searchboxProperties:{onSubmit:function(){h===!1?a(!0):o()}}});i.appendChild(n),cjExtensions.settings.get([E+"ThumbnailView",E+"FilterBy",E+"OrderBy"]).then(function(e){var t=e[E+"ThumbnailView"];"boolean"==typeof t&&(y=t);var a=e[E+"FilterBy"];"string"==typeof a&&(v=a);var l=e[E+"OrderBy"];"string"==typeof l&&(f=l);var m=c();i.appendChild(m),r=cjMaterial.createElement("container",{shadow:!0}),i.appendChild(r),p=s(),i.appendChild(p),d=n.searchbox,_(d.select),o()});var t=cjMaterial.createElement("fab",{label:cjExtensions.i18n("cj_i18n_00090","New file"),iconName:"__mdi:add",onClick:function(){bmBasics.openTab(e.newFileUrl)}});i.appendChild(t)}var r,d,m,p,u,_=n.onPageDisplay,h=!1,b="",j="(mimeType = '"+e.mimeTypes.join("' or mimeType = '")+"')",v="all",f="lastOpenedByMe",E="pref"+e.pageId,y=e.listview,w=e.pageId,C=Promise.all([cjBasics.loadStyleFile("stylesheets/g-doclist.css"),cjBasics.loadScriptFile("scripts/g-doclist.js")]),x={all:null,owned:"'me' in owners",shared:"sharedWithMe"},T={name:"name",lastModified:"modifiedTime desc",lastModifiedByMe:"modifiedByMeTime desc",lastOpenedByMe:"viewedByMeTime desc"},N={docs:{label:cjExtensions.i18n("cj_i18n_00391","Docs"),iconName:"__mdi:drive_document",color:"#4285f4",colorIcon:!0,newTabUrl:"https://docs.google.com/document/u/"+g.account.authuser+"/",page:"docs"},sheets:{label:cjExtensions.i18n("cj_i18n_00393","Sheets"),iconName:"__mdi:drive_spreadsheet",color:"#34a853",colorIcon:!0,newTabUrl:"https://docs.google.com/spreadsheets/u/"+g.account.authuser+"/",page:"sheets"},slides:{label:cjExtensions.i18n("cj_i18n_00407","Slides"),iconName:"__mdi:drive_presentation",color:"#ffcd40",colorIcon:!0,newTabUrl:"https://docs.google.com/presentation/u/"+g.account.authuser+"/",page:"slides"},forms:{label:cjExtensions.i18n("cj_i18n_00408","Forms"),iconName:"__mdi:drive_form",color:"#673ab7",colorIcon:!0,newTabUrl:"https://docs.google.com/forms/u/"+g.account.authuser+"/",page:"forms",divider:!0}};"atari"===w&&(N.forms.divider=!1,N.sites={label:cjExtensions.i18n("cj_i18n_00111","Classic Sites"),iconName:"__mdi:cj_drive_sites",color:"#4285f4",colorIcon:!0,newTabUrl:"https://sites.google.com/u/"+g.account.authuser+"/",divider:!0}),N.drive={label:cjExtensions.i18n("cj_i18n_00390","Drive"),iconName:"__mdi:drive",newTabUrl:"https://drive.google.com/u/"+g.account.authuser+"/",divider:!0},g.auth.getAccessToken(["https://www.googleapis.com/auth/drive"])["catch"](function(n){i.textContent="";var t=bmElements.createElement("fulldialog",{serviceLogo:{label:e.serviceName},iconName:e.iconName,message:"Before you can use this page, you need to give the extension access to Google Drive",actionLabel:cjExtensions.i18n("cj_i18n_00224","Give permission"),action:n.authorize});i.appendChild(t)}),n.setOpenInNewHandler(function(){var i=e.mainUrl;h&&e.searchUrl&&(i=e.searchUrl+encodeURIComponent(b)),bmBasics.openTab(i)}),l()}}});