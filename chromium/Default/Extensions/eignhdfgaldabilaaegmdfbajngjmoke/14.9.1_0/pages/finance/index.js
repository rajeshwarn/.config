cjModules.define(function(){"use strict";return function(e,t){function a(t){e.dataset.view=t,m.selected=t}function n(){var t=cjMaterial.createElement("drawer",{color:"#34a853"}),a=bmElements.createElement("servicelogo",{label:cjExtensions.i18n("cj_i18n_00412","Finance"),color:"#34a853"});t.appendChild(a);var n=bmElements.createElement("drawertabs",{items:h,onChange:function(t){e.dataset.view=t,m.selected=t},selected:f});return t.appendChild(n),t}function c(){return cjBasics.ajax({url:cjBasics.urls.create("https://www.google.com/finance/ig/sectorsummary",{output:"json",hl:g.lang})}).then(function(e){var t=e.replace("//","").replace(/\\x26/g,"&");return JSON.parse(t)})}function r(e){var t=cjMaterial.createElement("appbar",{color:"#34a853",secondary:!0}),a=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){p.open()}});t.appendChild(a);var n=cjMaterial.createElement("title",{label:h.markets.label});t.appendChild(n),e.appendChild(t);var r=cjMaterial.createElement("container",{shadow:!0});e.appendChild(r);var o=cjMaterial.createElement("subheader",{label:cjExtensions.i18n("cj_i18n_00068","Sector summary")});r.appendChild(o);var i=cjMaterial.createElement("card",{withPadding:!0}),l=document.createElement("div");l.className="sector-summary-item";var s=document.createElement("div");s.textContent=cjExtensions.i18n("cj_i18n_00069","Sector"),s.className="sector-summary-name-header",l.appendChild(s);var d=document.createElement("div");d.textContent=cjExtensions.i18n("cj_i18n_00070","Change"),d.className="sector-summary-change-header",l.appendChild(d);var m=document.createElement("div");m.textContent=cjExtensions.i18n("cj_i18n_00071","% down / up"),m.className="sector-summary-graph-header",l.appendChild(m),i.appendChild(l),c().then(function(e){e.forEach(function(e){var t=document.createElement("div");t.className="sector-summary-item";var a=document.createElement("div");a.className="sector-summary-name",a.textContent=e.name,a.title=e.name,t.appendChild(a);var n=document.createElement("div");n.className="sector-summary-change";var c=JSON.parse(e.cp).toFixed(2);n.textContent=c,n.dataset.type=0>c?"negative":"positive",t.appendChild(n);var r=document.createElement("div");r.className="sector-summary-graph",t.appendChild(r);var o=JSON.parse(e.maxgainerscp),l=JSON.parse(e.maxloserscp),s=o+l,d=JSON.parse(e.lltpivot),m=JSON.parse(e.lgtpivot),p=JSON.parse(e.gltpivot),u=JSON.parse(e.ggtpivot),h={emptydown:l-d-m,lltpivot:d,lgtpivot:m,gltpivot:p,ggtpivot:u,emptyup:o-p-u};Object.keys(h).forEach(function(t){var a=document.createElement("div");a.style.width=h[t]/s*100+"%",a.className="sector-summary-graph-"+t,e[t]&&(a.title=e[t]+"%"),r.appendChild(a)}),i.appendChild(t)}),r.appendChild(i)})}function o(e){var t=cjMaterial.createElement("card",{withPadding:!0}),a=cjMaterial.createElement("title",{label:e.name});t.appendChild(a);var n=document.createElement("div");n.className="cj-md-secondarytext",n.textContent=e.symbol+" - "+e.lastTime,t.appendChild(n);var c=document.createElement("div");c.className="portfolio-pricecontainer";var r=document.createElement("div");r.className="portfolio-lastprice",r.textContent=e.lastPrice,c.appendChild(r);var o=document.createElement("div");o.className="portfolio-changetoday";var i=e.changeToday<0,l=cjMaterial.createElement("icon",{name:i?"__mdi:trending_down":"__mdi:trending_up",color:i?"#ea4335":"#34a853"});c.appendChild(l),o.dataset.type=i?"negative":"positive",o.textContent=e.changeToday.replace("+","").replace("-","")+" ("+e.percentageChange+"%)",c.appendChild(o),t.appendChild(c);var s=[{name:cjExtensions.i18n("cj_i18n_00072","High"),value:e.high},{name:cjExtensions.i18n("cj_i18n_00073","Low"),value:e.low},{name:cjExtensions.i18n("cj_i18n_00074","Market cap"),value:e.marketCap}],d=document.createElement("article");return s.forEach(function(e){var t=document.createElement("div");t.className="portfolio-moredetail";var a=document.createElement("div");a.textContent=e.name||"",t.appendChild(a);var n=document.createElement("div");n.textContent=e.value,t.appendChild(n),d.appendChild(t)}),t.appendChild(d),t}function i(){var e=u;bmBasics.toggleLoading("on",e);var t=cjBasics.urls.create("https://www.google.com/finance/portfolio",{output:"xml",authuser:g.account.authuser});cjBasics.ajax({url:t,dataType:"XML"}).then(function(t){e.textContent="";var a=t.querySelectorAll("Data>Portfolios>Portfolio");[].forEach.call(a,function(t){var a=cjMaterial.createElement("subheader",{label:t.querySelector("Name").textContent});e.appendChild(a);var n=t.querySelectorAll("Data>Portfolios>Portfolio>Item");[].forEach.call(n,function(t){var a={name:t.querySelector("Name").textContent,symbol:t.querySelector("Symbol").textContent,lastTime:t.querySelector("LastTime").textContent,changeToday:t.querySelector("StockInfo>ChangeToday").textContent,percentageChange:t.querySelector("StockInfo>PercentageChange").textContent,lastPrice:t.querySelector("StockInfo>LastPrice").textContent,marketCap:t.querySelector("StockInfo>MarketCap").textContent,high:t.querySelector("StockInfo>High").textContent,low:t.querySelector("StockInfo>Low").textContent},n=o(a);e.appendChild(n)})}),bmBasics.toggleLoading("off",e)})}function l(){var e=cjMaterial.createElement("container"),t=cjMaterial.createElement("appbar",{color:"#34a853",secondary:!0}),a=cjMaterial.createElement("iconbutton",{iconName:"__mdi:menu",onClick:function(){p.open()}});t.appendChild(a);var n=cjMaterial.createElement("title",{label:h.portfolio.label});t.appendChild(n),e.appendChild(t);var c=cjMaterial.createElement("fab",{label:cjExtensions.i18n("cj_i18n_00150","Add portfolio"),iconName:"__mdi:add",onClick:function(){bmBasics.openTab("https://www.google.com/finance/portfolio?authuser="+g.account.authuser+"&action=create")}});e.appendChild(c);var r=cjMaterial.createElement("iconbutton",{iconName:"__mdi:refresh",onClick:i});return t.appendChild(r),u=cjMaterial.createElement("container",{scrollable:!0,shadow:!0}),e.appendChild(u),e}function s(e){var t=cjBasics.urls.create("https://www.google.com/finance",{q:e});bmBasics.openTab(t)}function d(){h={portfolio:{label:cjExtensions.i18n("cj_i18n_00065","Portfolios"),iconName:"__mdi:account_circle",content:l,afterLoad:i,newTabUrl:"https://www.google.com/finance/portfolio?authuser="+g.account.authuser},markets:{label:cjExtensions.i18n("cj_i18n_00066","Markets"),iconName:"__mdi:trending_up",content:function(){return cjMaterial.createElement("container")},afterLoad:r,newTabUrl:"https://www.google.com/finance?authuser="+g.account.authuser},news:{label:cjExtensions.i18n("cj_i18n_00067","News"),iconName:"__mdi:news",content:function(){return bmElements.createElement("iframe",{src:location.href.split("?")[0]+"?page=news&embed-in-finance=true"})},newTabUrl:"https://www.google.com/finance/market_news?authuser="+g.account.authuser}},m=bmElements.createElement("multiplecontainer",{items:h,darker:!0}),t.setOpenInNewHandler(function(){var e=h[m.selected].newTabUrl;bmBasics.openTab(e)}),p=n(),window.financeSidenav=p;var c=bmElements.createElement("pageheader",{pageId:"finance",color:"#34a853",searchboxProperties:{onSubmit:s,submitInNewTab:!0}});e.appendChild(c),v(c.searchbox.select),e.appendChild(m),e.appendChild(p),a(f)}var m,p,u,h,v=t.onPageDisplay,f="portfolio";d()}});